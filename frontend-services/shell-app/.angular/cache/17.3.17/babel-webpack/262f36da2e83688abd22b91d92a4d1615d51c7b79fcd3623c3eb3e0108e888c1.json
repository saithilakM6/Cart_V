{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/delivery.service\";\nimport * as i2 from \"../../services/order.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction DeliveryAgentDashboardComponent_div_34_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22)(1, \"div\", 23)(2, \"span\", 24);\n    i0.ɵɵtext(3, \"Loading...\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction DeliveryAgentDashboardComponent_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵtext(1, \" No orders to deliver \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction DeliveryAgentDashboardComponent_div_36_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 26)(1, \"div\", 12)(2, \"div\", 27)(3, \"div\", 28)(4, \"h6\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 29)(7, \"strong\");\n    i0.ɵɵtext(8, \"Customer:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\", 29)(11, \"strong\");\n    i0.ɵɵtext(12, \"Phone:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\", 29)(15, \"strong\");\n    i0.ɵɵtext(16, \"Address:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"p\", 29)(19, \"strong\");\n    i0.ɵɵtext(20, \"Amount:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(22, \"div\", 28)(23, \"p\", 30)(24, \"strong\");\n    i0.ɵɵtext(25, \"Status:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"span\", 31);\n    i0.ɵɵtext(27);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(28, \"div\", 32)(29, \"button\", 33);\n    i0.ɵɵlistener(\"click\", function DeliveryAgentDashboardComponent_div_36_Template_button_click_29_listener() {\n      const order_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.updateOrderStatus(order_r2.id, \"PROCESSING\"));\n    });\n    i0.ɵɵtext(30, \" Start Delivery \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(31, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function DeliveryAgentDashboardComponent_div_36_Template_button_click_31_listener() {\n      const order_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.updateOrderStatus(order_r2.id, \"SHIPPED\"));\n    });\n    i0.ɵɵtext(32, \" Out for Delivery \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(33, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function DeliveryAgentDashboardComponent_div_36_Template_button_click_33_listener() {\n      const order_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.updateOrderStatus(order_r2.id, \"DELIVERED\"));\n    });\n    i0.ɵɵtext(34, \" Delivered \");\n    i0.ɵɵelementEnd()()()()()();\n  }\n  if (rf & 2) {\n    const order_r2 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"Order #\", order_r2.id, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", order_r2.user == null ? null : order_r2.user.name, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", order_r2.phoneNumber, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", order_r2.deliveryAddress, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \\u20B9\", order_r2.totalAmount, \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵclassMap(\"bg-\" + ctx_r2.getStatusColor(order_r2.status));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(order_r2.status);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", order_r2.status !== \"CONFIRMED\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", order_r2.status !== \"PROCESSING\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", order_r2.status !== \"SHIPPED\");\n  }\n}\nexport let DeliveryAgentDashboardComponent = /*#__PURE__*/(() => {\n  class DeliveryAgentDashboardComponent {\n    constructor(deliveryService, orderService, router) {\n      this.deliveryService = deliveryService;\n      this.orderService = orderService;\n      this.router = router;\n      this.agent = null;\n      this.orders = [];\n      this.filteredOrders = [];\n      this.statusFilter = '';\n      this.isLoading = true;\n    }\n    ngOnInit() {\n      const agentData = localStorage.getItem('deliveryAgent');\n      if (!agentData) {\n        this.router.navigate(['/delivery-agent/login']);\n        return;\n      }\n      this.agent = JSON.parse(agentData);\n      this.loadOrders();\n    }\n    loadOrders() {\n      this.isLoading = true;\n      this.deliveryService.getDeliveryOrders().subscribe({\n        next: orders => {\n          this.orders = orders;\n          this.filterOrders();\n          this.isLoading = false;\n        },\n        error: error => {\n          console.error('Error loading orders:', error);\n          this.isLoading = false;\n        }\n      });\n    }\n    filterOrders() {\n      if (this.statusFilter) {\n        this.filteredOrders = this.orders.filter(o => o.status === this.statusFilter);\n      } else {\n        this.filteredOrders = this.orders;\n      }\n    }\n    updateOrderStatus(orderId, newStatus) {\n      this.deliveryService.updateDeliveryStatus(orderId, newStatus).subscribe({\n        next: () => {\n          alert('Order status updated');\n          this.loadOrders();\n        },\n        error: error => {\n          alert('Error updating status');\n        }\n      });\n    }\n    updateAgentStatus(newStatus) {\n      console.log('Updating agent status:', this.agent, 'New status:', newStatus);\n      if (!this.agent || !this.agent.id) {\n        alert('Agent ID not found. Please login again.');\n        return;\n      }\n      this.deliveryService.updateAgentStatus(this.agent.id, newStatus).subscribe({\n        next: () => {\n          this.agent.status = newStatus;\n          localStorage.setItem('deliveryAgent', JSON.stringify(this.agent));\n          alert('Status updated');\n        },\n        error: error => {\n          console.error('Error updating status:', error);\n          alert('Error updating status: ' + (error.error?.message || error.message));\n        }\n      });\n    }\n    logout() {\n      localStorage.removeItem('deliveryAgent');\n      this.router.navigate(['/delivery-agent/login']);\n    }\n    getStatusColor(status) {\n      switch (status) {\n        case 'DELIVERED':\n          return 'success';\n        case 'SHIPPED':\n          return 'warning';\n        case 'CONFIRMED':\n        case 'PROCESSING':\n          return 'info';\n        default:\n          return 'secondary';\n      }\n    }\n    static {\n      this.ɵfac = function DeliveryAgentDashboardComponent_Factory(t) {\n        return new (t || DeliveryAgentDashboardComponent)(i0.ɵɵdirectiveInject(i1.DeliveryService), i0.ɵɵdirectiveInject(i2.OrderService), i0.ɵɵdirectiveInject(i3.Router));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: DeliveryAgentDashboardComponent,\n        selectors: [[\"app-delivery-agent-dashboard\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 37,\n        vars: 12,\n        consts: [[1, \"container-fluid\", \"mt-4\"], [1, \"row\", \"mb-4\"], [1, \"col-md-8\"], [1, \"text-muted\"], [1, \"badge\", \"bg-info\"], [1, \"col-md-4\", \"text-end\"], [1, \"btn-group\"], [1, \"btn\", \"btn-sm\", 3, \"click\"], [1, \"btn\", \"btn-danger\", \"btn-sm\", \"ms-2\", 3, \"click\"], [1, \"row\", \"mb-3\"], [1, \"col-md-12\"], [1, \"card\"], [1, \"card-body\"], [1, \"form-label\"], [1, \"form-select\", 3, \"ngModelChange\", \"change\", \"ngModel\"], [\"value\", \"\"], [\"value\", \"CONFIRMED\"], [\"value\", \"PROCESSING\"], [\"value\", \"SHIPPED\"], [\"class\", \"text-center\", 4, \"ngIf\"], [\"class\", \"alert alert-info\", 4, \"ngIf\"], [\"class\", \"card mb-3\", 4, \"ngFor\", \"ngForOf\"], [1, \"text-center\"], [\"role\", \"status\", 1, \"spinner-border\"], [1, \"visually-hidden\"], [1, \"alert\", \"alert-info\"], [1, \"card\", \"mb-3\"], [1, \"row\"], [1, \"col-md-6\"], [1, \"mb-1\"], [1, \"mb-2\"], [1, \"badge\"], [\"role\", \"group\", 1, \"btn-group\"], [1, \"btn\", \"btn-sm\", \"btn-outline-primary\", 3, \"click\", \"disabled\"], [1, \"btn\", \"btn-sm\", \"btn-outline-success\", 3, \"click\", \"disabled\"]],\n        template: function DeliveryAgentDashboardComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h2\");\n            i0.ɵɵtext(4, \"Delivery Dashboard\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"p\", 3);\n            i0.ɵɵtext(6);\n            i0.ɵɵelementStart(7, \"span\", 4);\n            i0.ɵɵtext(8);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(9, \"div\", 5)(10, \"div\", 6)(11, \"button\", 7);\n            i0.ɵɵlistener(\"click\", function DeliveryAgentDashboardComponent_Template_button_click_11_listener() {\n              return ctx.updateAgentStatus(\"AVAILABLE\");\n            });\n            i0.ɵɵtext(12, \"Available\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(13, \"button\", 7);\n            i0.ɵɵlistener(\"click\", function DeliveryAgentDashboardComponent_Template_button_click_13_listener() {\n              return ctx.updateAgentStatus(\"BUSY\");\n            });\n            i0.ɵɵtext(14, \"Busy\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(15, \"button\", 7);\n            i0.ɵɵlistener(\"click\", function DeliveryAgentDashboardComponent_Template_button_click_15_listener() {\n              return ctx.updateAgentStatus(\"OFFLINE\");\n            });\n            i0.ɵɵtext(16, \"Offline\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(17, \"button\", 8);\n            i0.ɵɵlistener(\"click\", function DeliveryAgentDashboardComponent_Template_button_click_17_listener() {\n              return ctx.logout();\n            });\n            i0.ɵɵtext(18, \"Logout\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(19, \"div\", 9)(20, \"div\", 10)(21, \"div\", 11)(22, \"div\", 12)(23, \"label\", 13);\n            i0.ɵɵtext(24, \"Filter by Status\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(25, \"select\", 14);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function DeliveryAgentDashboardComponent_Template_select_ngModelChange_25_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.statusFilter, $event) || (ctx.statusFilter = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"change\", function DeliveryAgentDashboardComponent_Template_select_change_25_listener() {\n              return ctx.filterOrders();\n            });\n            i0.ɵɵelementStart(26, \"option\", 15);\n            i0.ɵɵtext(27, \"All Orders\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(28, \"option\", 16);\n            i0.ɵɵtext(29, \"Confirmed\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(30, \"option\", 17);\n            i0.ɵɵtext(31, \"Processing\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(32, \"option\", 18);\n            i0.ɵɵtext(33, \"Out for Delivery\");\n            i0.ɵɵelementEnd()()()()()();\n            i0.ɵɵtemplate(34, DeliveryAgentDashboardComponent_div_34_Template, 4, 0, \"div\", 19)(35, DeliveryAgentDashboardComponent_div_35_Template, 2, 0, \"div\", 20)(36, DeliveryAgentDashboardComponent_div_36_Template, 35, 11, \"div\", 21);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(6);\n            i0.ɵɵtextInterpolate1(\"Agent: \", ctx.agent == null ? null : ctx.agent.name, \" | Status: \");\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate(ctx.agent == null ? null : ctx.agent.status);\n            i0.ɵɵadvance(3);\n            i0.ɵɵclassProp(\"btn-success\", (ctx.agent == null ? null : ctx.agent.status) === \"AVAILABLE\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵclassProp(\"btn-warning\", (ctx.agent == null ? null : ctx.agent.status) === \"BUSY\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵclassProp(\"btn-secondary\", (ctx.agent == null ? null : ctx.agent.status) === \"OFFLINE\");\n            i0.ɵɵadvance(10);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.statusFilter);\n            i0.ɵɵadvance(9);\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.isLoading && ctx.filteredOrders.length === 0);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngForOf\", ctx.filteredOrders);\n          }\n        },\n        dependencies: [CommonModule, i4.NgForOf, i4.NgIf, FormsModule, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgModel],\n        styles: [\".card[_ngcontent-%COMP%]{border:none;border-radius:8px;box-shadow:0 2px 4px #0000001a}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:4px;margin-right:5px}.badge[_ngcontent-%COMP%]{padding:5px 10px;font-size:12px}h2[_ngcontent-%COMP%]{color:#333;font-weight:600}\"]\n      });\n    }\n  }\n  return DeliveryAgentDashboardComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}