{"ast":null,"code":"import { BehaviorSubject, tap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"./api-config.service\";\nexport let AuthService = /*#__PURE__*/(() => {\n  class AuthService {\n    constructor(http, apiConfig) {\n      this.http = http;\n      this.apiConfig = apiConfig;\n      this.currentUserSubject = new BehaviorSubject(null);\n      this.currentUser$ = this.currentUserSubject.asObservable();\n      this.showWelcomeSubject = new BehaviorSubject(false);\n      this.showWelcome$ = this.showWelcomeSubject.asObservable();\n      this.apiUrl = this.apiConfig.getApiUrl('auth');\n      const user = localStorage.getItem('currentUser');\n      if (user) {\n        this.currentUserSubject.next(JSON.parse(user));\n      }\n    }\n    login(email, password) {\n      return this.http.post(`${this.apiUrl}/signin`, {\n        email,\n        password\n      }).pipe(tap(response => {\n        if (response.token) {\n          this.setCurrentUser(response, response.token);\n        }\n      }));\n    }\n    register(userData) {\n      return this.http.post(`${this.apiUrl}/signup`, userData);\n    }\n    logout() {\n      localStorage.removeItem('currentUser');\n      localStorage.removeItem('token');\n      localStorage.removeItem('cart');\n      this.currentUserSubject.next(null);\n    }\n    isAuthenticated() {\n      return !!localStorage.getItem('token');\n    }\n    getToken() {\n      return localStorage.getItem('token');\n    }\n    getCurrentUser() {\n      return this.currentUserSubject.value;\n    }\n    setCurrentUser(user, token) {\n      localStorage.setItem('currentUser', JSON.stringify(user));\n      localStorage.setItem('token', token);\n      this.currentUserSubject.next(user);\n      this.showWelcomeSubject.next(true);\n    }\n    hideWelcome() {\n      this.showWelcomeSubject.next(false);\n    }\n    isAdmin() {\n      const user = this.getCurrentUser();\n      if (!user) return false;\n      const role = user.role ? user.role.toString().toUpperCase() : '';\n      return role === 'ADMIN' || role.includes('ADMIN');\n    }\n    getUserRole() {\n      const user = this.getCurrentUser();\n      return user ? user.role : 'USER';\n    }\n    getFirstName() {\n      const user = this.getCurrentUser();\n      return user ? user.firstName : '';\n    }\n    getLastName() {\n      const user = this.getCurrentUser();\n      return user ? user.lastName : '';\n    }\n    getProfilePicture() {\n      const user = this.getCurrentUser();\n      return user ? user.profilePicture : null;\n    }\n    forgotPassword(email) {\n      return this.http.post(`${this.apiUrl}/forgot-password?email=${email}`, {});\n    }\n    verifyResetOtp(email, otp) {\n      return this.http.post(`${this.apiUrl}/verify-reset-otp?email=${email}&otp=${otp}`, {});\n    }\n    resetPassword(email, newPassword) {\n      return this.http.post(`${this.apiUrl}/reset-password?email=${email}&newPassword=${newPassword}`, {});\n    }\n    sendOtp(email) {\n      return this.http.post(`${this.apiUrl}/send-otp?email=${email}`, {});\n    }\n    verifyOtp(email, otp) {\n      return this.http.post(`${this.apiUrl}/verify-otp?email=${email}&otp=${otp}`, {});\n    }\n    googleLogin(token) {\n      return this.http.post(`${this.apiUrl}/oauth2/google`, {\n        token\n      }).pipe(tap(response => {\n        if (response.token) {\n          this.setCurrentUser(response, response.token);\n        }\n      }));\n    }\n    googleCallback(code) {\n      return this.http.post(`${this.apiUrl}/google/callback`, {\n        code\n      }).pipe(tap(response => {\n        if (response.token) {\n          this.setCurrentUser(response, response.token);\n        }\n      }));\n    }\n    static {\n      this.ɵfac = function AuthService_Factory(t) {\n        return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.ApiConfigService));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: AuthService,\n        factory: AuthService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return AuthService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}